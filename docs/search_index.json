[["index.html", "The Penn World Table in Excel Introduction", " The Penn World Table in Excel Marion Prat 2024-06-10 Introduction Note that this resource is still a work in progress. You can write to me at: marion.prat@bristol.ac.uk. In this tutorial, we will show how to extract useful empirical facts about long-run growth from the Penn World Table (Feenstra, Inklaar, and P.Timmer 2015) using basic functions and operations in Excel. The PWT 10.01 contains data on GDP and its components, as well as demographic characteristics for 183 countries from 1950 to 2019 (although for some countries the data may not be available as early as 1950). Download the PWT 10.01 Excel spreadsheet here and save it in a folder entitled PWT. The spreadsheet contains three sheets: “Info”, “Legend” and “Data”. Before going any further, check the definition of the variables in the “Legend” sheet. Why are there so many different measures of real GDP? How do they differ? The “Data” sheet contains the dataset. Each row corresponds to observations for a given country in a given year and each column represents a variable. Although this layout may appear confusing at first, it is in fact computer friendly: First, it is easy to use a Power Query in the Data tab (accessed via “Get Data”) to create a new Excel sheet containing any subset of the data you are interested in analysing. This is what we are going to do in this tutorial. Second, it is compatible with how statistical software (such as R) work as they store variables in column vectors. References "],["preparing-the-dataset.html", "Chapter 1 Preparing the dataset 1.1 Extracting the relevant information 1.2 Freezing panes 1.3 Hiding rows or columns 1.4 Sorting observations", " Chapter 1 Preparing the dataset 1.1 Extracting the relevant information Assume we are only interested in working with the variables “year”, “rgdpo” and “pop” for the United Kingdom. It will be useful to create a new spreadsheet containing only the data needed for this analysis. We present two methods that can be employed to extract the relevant data from the main spreadsheet. Method 1: Brute force method Click on the arrow next to “country” (Column B) and select the country of your choice (here the United Kingdom). Tip: first click on Select all to unselect all countries. To select the rows containing UK data, click on the first row and on the last row in the range while pressing the shift key at the same time. Create a new spreadsheet, rename it “United Kingdom” and paste the data. Delete all the columns that are not needed. Go to Insert and click on Table. In the “Create Table” box, select “My table has headers” and click OK. The following table should appear. Method 2: Smart method (more likely to avoid mistakes) Go to Data, and click on Get Data Select From File, then From Excel Workbook Select pwt1001 (in the folder where you saved it) and click on Import. In the Navigator box, select the Data spreadsheet and press Transform Data In the Data - Power Query Editor box, press the arrow next to country and select United Kingdom Press the arrow next to Choose Columns and select year, rgdpo and pop In the Properties on the right, write the name of the new spreadsheet (“United Kingdom”). Then click on Close &amp; Load to create the new spreadsheet The new spreadsheet “United Kingdom” contains a table with three columns corresponding to “year”, “rgdpo” and “pop” Practice exercise: create a new spreadsheet entitled “1970” containing the three entries “country”, “rgdpo” and “pop” for the year 1970. 1.2 Freezing panes To freeze the top row, go to View, then Freeze pane and select Freeze Top Row. The top row remains visible while scrolling through the rest of the worksheet. Similarly it is possible to freeze the first column. 1.3 Hiding rows or columns To show data for selected years only, for example the first and the last (1950 and 2019), click on the arrow next to year and select “1950” and “2019”, then click OK. Only the first and last observations appear! To hide a column (or a row), right click on its letter (or number) header (eg “C”) and select hide. Select unhide to reverse this action. 1.4 Sorting observations In the “1970” spreadsheet (See Practice exercise in Section 1.1), countries by default are listed in alphabetical order. To sort the countries from the wealthiest to the poorest in terms of GDP, click on the arrow next to “rgdpo” and select “Sort Largest to smallest” to rearrange the countries in descending values of GDP. "],["calculations-in-excel.html", "Chapter 2 Calculations in Excel 2.1 Basic arithmetic calculations 2.2 Excel built-in functions 2.3 Write formulas referring to values in other cells", " Chapter 2 Calculations in Excel 2.1 Basic arithmetic calculations A formula in Excel always starts with an equal sign = Arithmetic operators: + (addition), - (subtraction), * (multiplication), / (division), ^ (exponentiation). Example 1: to calculate “\\(3 + 2 \\times 4 + 6^2\\)” in Excel, select a cell, type: and press “Enter”. Example 2: to calculate “\\(3 \\times (3+8) + \\frac{2}{3+1} + 6^{1/2}\\)” in Excel, select a cell, type: and press “Enter”. 2.2 Excel built-in functions For more complex operations, it will be more convenient to use the Excel built-in functions. To let Excel help you find the relevant function and use it, select a cell and write an equal sign. In the top left corner, a drop-down menu appears with a list of the most commonly used formulas. If the function you are looking for does not appear here, go to “More Functions” at the bottom of the menu. A search box will prompt you to describe the function you are interested in. Example: the function “AVERAGE” calculates the average of two or several numbers. To calculate the average of 6 and 4, enter 4 and 6 in the “Function Arguments” box or write directly “=AVERAGE(6,4)”. 2.3 Write formulas referring to values in other cells In Excel, columns are indexed by letters and rows by numbers. Each cell therefore can be referenced by their column letter and row number. For example, “A3”, “C1”, “F6”. Example 1: to calculate “\\(3 + 2 \\times 4 + 6^2\\)”, it is possible to enter separately the values 3, 2, 4 and 6 into separate cells and then write a formula to perform this operation referring to the corresponding cells as follows: where “A2” is 3, “B2” is 2, “C2” is 4 and “D2” is 6. Example 2: to calculate the average of the four numbers used in the previous example using the AVERAGE() function, select the cells comprising the range of values you want to include in the calculation: "],["creating-new-variables.html", "Chapter 3 Creating new variables 3.1 Generating a new GDP per capita series 3.2 Calculating growth rates 3.3 Generating a series for the logarithm of a variable", " Chapter 3 Creating new variables 3.1 Generating a new GDP per capita series Using the data on GDP and population for the United Kingdom in the “United Kingdom” sheet we can generate a series of values for UK GDP per capita. For this, we need to create a formula referring to values in other cells. To calculate UK GDP per capita in 1950 we need to divide UK output (“rgdpo”) by UK population (“pop”). Select the cell where you want the result to appear (eg “D2”). The relevant formula for GDP per capita in 1950 is “=B2/C2”. “B2” is UK GDP in 1950, “C2” is UK population in 1950 and “/” indicates that you are dividing the former by the latter. Instead of writing “B2” and “C2” you may just click on the corresponding cells. To calculate UK GDP per capita in all subsequent years, we need to apply the same formula to all rows ( representing years) in the dataset. To do this you can either copy and paste the formula in all subsequent cells in the D column or double click on the “+” in the bottom right corner of D2, or click on the “+” and drag it over all the subsequent cells in the D column (whatever works for you!). If the data is presented in a table (as below), the formula in “D2” will apply automatically to all rows in column D. 3.2 Calculating growth rates Using the UK GDP per capita series, we can now create the series of annual growth rates of GDP per capita using the formula \\(g_y = \\frac{y_t}{y_{t-1}} -1\\). For example, the annual growth rate of UK GDP per capita in 1951 is equal to the ratio of GDP per capita in 1951 (“D3”) and in 1950 (“D2”) minus 1. Then copy the formula in all subsequent cells to generate the whole series of annual growth rates. 3.3 Generating a series for the logarithm of a variable To calculate a series for the natural logarithm of UK GDP per capita, use the LN() function: Then copy the formula in all subsequent cells to generate the whole series of annual growth rates. Important: to calculate the natural logarithm, do not use the LOG() function, which should only be used if you want to calculate the logarithm with a different base! "],["formatting-numbers.html", "Chapter 4 Formatting numbers", " Chapter 4 Formatting numbers The data in the table above contains numbers with various decimal points and the GDP growth rate in column E is expressed in decimal points. It is possible to make the data more presentable by using the “Number” options in the top ribbon (first select the “Home” tab). To express the annual growth rate in % instead of decimal points, select column D and click on the “%” icon. The same number is now expressed in %. However, the growth rate have been rounded to the nearest integer value. It might be useful to to have a more precise number displayed. To increase the number of decimal points, click on the icon indicated by the red arrow below as many time as you want to add decimal points. The variables “rgdpo” and “GDPPC” are large numbers expressed in millions of $, which may be easier to read by having a comma separate the 1000s. This can be done by selecting the columns on which you want to apply this change and clicking on the comma icon. The resulting table is easier to read. "],["create-plots.html", "Chapter 5 Create plots 5.1 Create a line chart 5.2 Log scale 5.3 Titles 5.4 Format axes 5.5 Add trend lines 5.6 Format chart area 5.7 Export plot to Word document", " Chapter 5 Create plots 5.1 Create a line chart To create a plot of the logarithm of UK GDP, select the “year” and “lnGDPPC” column, go to “Insert” and click on “Recommended charts”. Select the plot which has “year” on x-axis and “lnGDPPC” on the y-axis among the options proposed. Note: you may be tempted to select fancy layouts using the “Quick Layout” tab. Although it may be helpful in some cases, it is more likely to add unnecessary detail and therefore be more confusing to read. Better to invest in learning the chart elements can be modified to serve the purpose of each individual graph. 5.2 Log scale TBA 5.3 Titles To add or remove a char title, click on the chart and go to “Chart Design”, then “Add Chart Element”. Select “Chart title” to add or remove a plot title. Select “Axis Titles” to add titles to the horizontal and vertical axis. Note: depending on the plot, adding titles may not add much information. For example, in the case of the plot of the logarithm of UK GDP per capita, adding axis titles do not add much information as it is clear already that the horizontal axis represents dates and the plot title already explains what it represents. In other cases, it may be impossible to understand what is represented without axis titles. 5.4 Format axes Formatting axes properly may go a long way to produce a graph that is informative and immediately understandable. To format the horizontal axis: right click on the dates on the chart and select “Format axis”. To have the dates displayed only every 10 years, use the “Label” option. To format the vertical axis: right click on the vertical axis and select “Format axis”. To modify the range of the vertical axis so that it better fits the range in the data, change the minimum or the maximum in the “Bounds” tab. To reduce/increase the number of ticks, change “Major” in the “Units tab. To reduce the number of decimal points, go to the”Number” option and specify your preferred number of decimal points (eg 1). 5.5 Add trend lines To add a trend line, click on the chart and go to “Chart Design” and “Add Chart Element”. Then go to “Trendline” and select the shape of trend line that is the most relevant for your plot (here a linear trend because we plot the logarithm of GDP). 5.6 Format chart area Finally, altering the appearance of the line plot may improve the clarity of the graph. You may alter the thickness, the colour and the pattern of the line plot. To do so click on the line you wish to apply these changes to and select your preferred options. 5.7 Export plot to Word document Note: if you do not paste the plot as a picture in the Word document, it is the entire Excel sheet that you are including into your Word document. Pasting the document as a picture (as in the video) may be more efficient. "],["tables.html", "Chapter 6 Tables 6.1 Calculate compound growth rates in Excel 6.2 Formatting tables in Excel 6.3 Export an Excel table to a Word document", " Chapter 6 Tables We now want to calculate the trend growth rate of UK GDP per capita between 1950 and 2019 using our data from the Penn World Tables. In addition to the trend growth over the full sample period, we would like to calculate it over three subperiods that we have identified using the plot of the logarithm of GDP per capita: 1950-1990, 1990-2008 and 2008-2019. Finally we would like to present the results in a table in a Word document. 6.1 Calculate compound growth rates in Excel To calculate the trend growth rate we use the compound growth rate formula: \\(g = \\left(\\frac{y_{end}}{y_{start}}\\right)^{\\frac{1}{end-start}}-1\\) (multiplied by 100 to express the growth rate in %) 6.2 Formatting tables in Excel In this video, it is shown how to wrap text within a cell, how to center numbers (or text) within a cell, how to alter the background colour of the cells and how to add borders. The table is now ready to be exported into a Word document. 6.3 Export an Excel table to a Word document "],["large-language-models-in-excel.html", "Chapter 7 Large language models in Excel 7.1 Write an Excel formula 7.2 Extract data and create new variables", " Chapter 7 Large language models in Excel Many AI tools, among which large language models (LLMs) feature prominently, are embedded into Excel. We have already used some of these features in previous chapters: When you create a new variable in a new column using a formula, Excel will use it as an example to write the formula in all subsequent rows in the same column and automatically update as the data changes (“Formula by Example”). When creating a chart, Excel proposes a selection of charts that are the most likely to be relevant in “Recommended charts”. With the incorporation of Microsoft Copilot within Excel, the capabilities of generative AI tools in Excel is likely to increase. 7.1 Write an Excel formula If you do not know how to write a formula in Excel, you may ask a LLM to suggest a formula. Example: formula for the compound annual growth rate: Prompt (ChatGPT 4): I have annual GDP data spanning the period 1950 to 2019 in an Excel spreadsheet. Write an Excel formula I can use to calculate the compounded annual growth rate of GDP between 1950 and 2019. Explain carefully the formula. ChatGPT 4 offers the following reply: Check: Is the formula correct (check whether the reasoning is correct)? Can you use the formula in Excel to calculate the compound annual growth rate of UK GDP per capita? Be careful that the GPT may be “hallucinating” an Excel function. 7.2 Extract data and create new variables Large language models can also be used to perform most of the tasks discussed in the previous sections. Example: Extract UK data and create GDP per capita: Prompt (ChatGPT 4o): (attaching pwt1001.xlsx) Using the PWT10.01 dataset attached, do the following tasks. 1) extract “year”, “rgdpo” and “pop” for entries where “country” is equal to “United Kingdom”. 2) create a new variables for UK GDP per capita using the variables extracted. 3) create a new Excel spreadsheet including the new variable, ready to be downloaded. ChatGPT 4 offers the following reply: Python code used to extract the relevant data and create the new variable: Output: new Excel spreadsheet Opening the new spreadsheet: Check: Compare this spreadsheet with that created in Section 1.1. Check that the first entry for UK GDP per capita is correct. "],["useful-resources.html", "Useful resources", " Useful resources Microsoft support: Excel video training website Microsoft Excel 365 Bible. Ebook 2022 available via the University library website. Link "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
