<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Excel and Large language models | The Penn World Table in Excel</title>
  <meta name="description" content="Chapter 7 Excel and Large language models | The Penn World Table in Excel" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Excel and Large language models | The Penn World Table in Excel" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Excel and Large language models | The Penn World Table in Excel" />
  
  
  

<meta name="author" content="Marion Prat" />


<meta name="date" content="2025-01-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tables.html"/>
<link rel="next" href="useful-resources.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/mp16445/EXCEL_PWT" target="blank">The Penn World Tables in Excel</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="preparing-the-dataset.html"><a href="preparing-the-dataset.html"><i class="fa fa-check"></i><b>1</b> Preparing the dataset</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preparing-the-dataset.html"><a href="preparing-the-dataset.html#extracting-the-relevant-information"><i class="fa fa-check"></i><b>1.1</b> Extracting the relevant information</a></li>
<li class="chapter" data-level="1.2" data-path="preparing-the-dataset.html"><a href="preparing-the-dataset.html#freezing-panes"><i class="fa fa-check"></i><b>1.2</b> Freezing panes</a></li>
<li class="chapter" data-level="1.3" data-path="preparing-the-dataset.html"><a href="preparing-the-dataset.html#hiding-rows-or-columns"><i class="fa fa-check"></i><b>1.3</b> Hiding rows or columns</a></li>
<li class="chapter" data-level="1.4" data-path="preparing-the-dataset.html"><a href="preparing-the-dataset.html#sorting-observations"><i class="fa fa-check"></i><b>1.4</b> Sorting observations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="calculations-in-excel.html"><a href="calculations-in-excel.html"><i class="fa fa-check"></i><b>2</b> Calculations in Excel</a>
<ul>
<li class="chapter" data-level="2.1" data-path="calculations-in-excel.html"><a href="calculations-in-excel.html#basic-arithmetic-calculations"><i class="fa fa-check"></i><b>2.1</b> Basic arithmetic calculations</a></li>
<li class="chapter" data-level="2.2" data-path="calculations-in-excel.html"><a href="calculations-in-excel.html#excel-built-in-functions"><i class="fa fa-check"></i><b>2.2</b> Excel built-in functions</a></li>
<li class="chapter" data-level="2.3" data-path="calculations-in-excel.html"><a href="calculations-in-excel.html#write-formulas-referring-to-values-in-other-cells"><i class="fa fa-check"></i><b>2.3</b> Write formulas referring to values in other cells</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-new-variables.html"><a href="creating-new-variables.html"><i class="fa fa-check"></i><b>3</b> Creating new variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-new-variables.html"><a href="creating-new-variables.html#generating-new-variables"><i class="fa fa-check"></i><b>3.1</b> Generating new variables</a></li>
<li class="chapter" data-level="3.2" data-path="creating-new-variables.html"><a href="creating-new-variables.html#calculating-growth-rates"><i class="fa fa-check"></i><b>3.2</b> Calculating growth rates</a></li>
<li class="chapter" data-level="3.3" data-path="creating-new-variables.html"><a href="creating-new-variables.html#using-the-natural-logarithm-function"><i class="fa fa-check"></i><b>3.3</b> Using the natural logarithm function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="formatting-numbers.html"><a href="formatting-numbers.html"><i class="fa fa-check"></i><b>4</b> Formatting numbers</a></li>
<li class="chapter" data-level="5" data-path="create-plots.html"><a href="create-plots.html"><i class="fa fa-check"></i><b>5</b> Create plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="create-plots.html"><a href="create-plots.html#create-a-line-chart"><i class="fa fa-check"></i><b>5.1</b> Create a line chart</a></li>
<li class="chapter" data-level="5.2" data-path="create-plots.html"><a href="create-plots.html#titles"><i class="fa fa-check"></i><b>5.2</b> Titles</a></li>
<li class="chapter" data-level="5.3" data-path="create-plots.html"><a href="create-plots.html#format-axes"><i class="fa fa-check"></i><b>5.3</b> Format axes</a></li>
<li class="chapter" data-level="5.4" data-path="create-plots.html"><a href="create-plots.html#logarithimc-ratio-scale"><i class="fa fa-check"></i><b>5.4</b> Logarithimc (ratio) scale</a></li>
<li class="chapter" data-level="5.5" data-path="create-plots.html"><a href="create-plots.html#add-trend-lines"><i class="fa fa-check"></i><b>5.5</b> Add trend lines</a></li>
<li class="chapter" data-level="5.6" data-path="create-plots.html"><a href="create-plots.html#format-chart-area"><i class="fa fa-check"></i><b>5.6</b> Format chart area</a></li>
<li class="chapter" data-level="5.7" data-path="create-plots.html"><a href="create-plots.html#export-plot-to-word-document"><i class="fa fa-check"></i><b>5.7</b> Export plot to Word document</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>6</b> Tables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tables.html"><a href="tables.html#calculate-compound-growth-rates-in-excel"><i class="fa fa-check"></i><b>6.1</b> Calculate compound growth rates in Excel</a></li>
<li class="chapter" data-level="6.2" data-path="tables.html"><a href="tables.html#formatting-tables-in-excel"><i class="fa fa-check"></i><b>6.2</b> Formatting tables in Excel</a></li>
<li class="chapter" data-level="6.3" data-path="tables.html"><a href="tables.html#export-an-excel-table-to-a-word-document"><i class="fa fa-check"></i><b>6.3</b> Export an Excel table to a Word document</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="excel-and-large-language-models.html"><a href="excel-and-large-language-models.html"><i class="fa fa-check"></i><b>7</b> Excel and Large language models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="excel-and-large-language-models.html"><a href="excel-and-large-language-models.html#find-an-excel-formula"><i class="fa fa-check"></i><b>7.1</b> Find an Excel formula</a></li>
<li class="chapter" data-level="7.2" data-path="excel-and-large-language-models.html"><a href="excel-and-large-language-models.html#perform-operations-on-data"><i class="fa fa-check"></i><b>7.2</b> Perform operations on data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-resources.html"><a href="useful-resources.html"><i class="fa fa-check"></i>Useful resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Penn World Table in Excel</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="excel-and-large-language-models" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Excel and Large language models<a href="excel-and-large-language-models.html#excel-and-large-language-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Many AI tools are already embedded into Excel. We have already used some of these features in previous chapters:</p>
<ul>
<li>When you create a new variable in a new column using a formula, Excel will use it as an example to write the formula in all subsequent rows in the same column and automatically update as the data changes (“Formula by Example”).</li>
<li>When creating a chart, Excel proposes a selection of charts likely to be relevant in “Recommended charts”.</li>
</ul>
<p>With the incorporation of Large Language Models (LLMs) such as Microsoft Copilot within Excel, the capabilities of generative AI tools in Excel is likely to increase. In this section, we explore what these new capabilities may look like. It is strongly recommended that you perform all calculations using Excel or other programming software rather than ask an LLM to generate output for you.</p>
<p><em>All output in this section have been generated using ChatGPT4. You may not be able to replicate this output using Copilot as it can only accept files of size up to 1MB.</em></p>
<div id="find-an-excel-formula" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Find an Excel formula<a href="excel-and-large-language-models.html#find-an-excel-formula" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you do not know how to write a formula in Excel, you may ask a LLM to suggest a formula.</p>
<p><span style="color: blue;"><strong>Example: formula for the compound annual growth rate</strong></span>:</p>
<blockquote>
<p><strong>Prompt (ChatGPT 4)</strong>:
I have annual GDP data spanning the period 1950 to 2019 in an Excel spreadsheet. Write an Excel formula I can use to calculate the compounded annual growth rate of GDP between 1950 and 2019. Explain carefully the formula.</p>
</blockquote>
<p>ChatGPT 4 offers the following reply:</p>
<p><img src="images/CGPT4_CAGR.png" width="85%" height="85%" style="display: block; margin: auto;" /></p>
<p><span style="color: blue;"><strong>Check</strong></span>:</p>
<ul>
<li>Is the formula correct?</li>
<li>Can you use the formula in Excel to calculate the compound annual growth rate of UK GDP per capita?</li>
<li>Be careful that the GPT may be “hallucinating” an Excel function.</li>
</ul>
</div>
<div id="perform-operations-on-data" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Perform operations on data<a href="excel-and-large-language-models.html#perform-operations-on-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Large language models can also be used to perform most of the tasks discussed in the previous sections.</p>
<p><span style="color: blue;"><strong>Example: Extract UK data and create GDP per capita</strong></span>:</p>
<blockquote>
<p><strong>Prompt (ChatGPT 4o)</strong>: (attaching pwt1001.xlsx) Using the PWT10.01 dataset attached, do the following tasks. 1) extract “year”, “rgdpo” and “pop” for entries where “country” is equal to “United Kingdom”. 2) create a new variables for UK GDP per capita using the variables extracted. 3) create a new Excel spreadsheet including the new variable, ready to be downloaded.</p>
</blockquote>
<p>ChatGPT 4 generates:</p>
<ol style="list-style-type: decimal">
<li><p>Python code used to extract the relevant data and create the new variable.</p></li>
<li><p>Output: new Excel spreadsheet</p></li>
</ol>
<p><img src="images/CGPT4o_UK.png" width="85%" height="85%" style="display: block; margin: auto;" /></p>
<p>Opening the new spreadsheet:</p>
<p><img src="images/CGPT4o_UK2.png" width="50%" height="50%" style="display: block; margin: auto;" /></p>
<p><span style="color: blue;"><strong>Check</strong></span>:</p>
<ul>
<li>Compare this spreadsheet with that created in Section 1.1.</li>
<li>Check that the first entry for UK GDP per capita is correct.</li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="useful-resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
